create database Sqlbiproject;
use Sqlbiproject;


CREATE TABLE Customers (
    CustomerID INT PRIMARY KEY,
    CustomerName VARCHAR(50),
    Region VARCHAR(20)
);

CREATE TABLE Products (
    ProductID INT PRIMARY KEY,
    Category VARCHAR(20),
    SubCategory VARCHAR(20),
    Product VARCHAR(50)
);

CREATE TABLE Sales (
    OrderID INT PRIMARY KEY,
    OrderDate DATE,
    CustomerID INT,
    ProductID INT,
    Quantity INT,
    Sales DECIMAL(10,2),
    Profit DECIMAL(10,2),
    FOREIGN KEY (CustomerID) REFERENCES Customers(CustomerID),
    FOREIGN KEY (ProductID) REFERENCES Products(ProductID)
);


-- Customers Table
INSERT INTO Customers (CustomerID, CustomerName, Region) VALUES
(1, 'John Smith', 'East'),
(2, 'Priya Mehta', 'West'),
(3, 'Rohan Patel', 'South'),
(4, 'Sarah Lee', 'East'),
(5, 'Amit Kumar', 'North'),
(6, 'Neha Sharma', 'South'),
(7, 'Anil Singh', 'West');

INSERT INTO Products (ProductID, Category, SubCategory, Product) VALUES
(101, 'Furniture', 'Chair', 'Office Chair'),
(102, 'Furniture', 'Table', 'Dining Table'),
(103, 'Tech', 'Laptop', 'Dell Inspiron'),
(104, 'Office', 'Paper', 'A4 Paper'),
(105, 'Tech', 'Phone', 'iPhone 13'),
(106, 'Furniture', 'Sofa', 'Leather Sofa'),
(107, 'Tech', 'Monitor', 'Samsung Monitor');

-- Sales Table
INSERT INTO Sales (OrderID, OrderDate, CustomerID, ProductID, Quantity, Sales, Profit) VALUES
(1001, '2023-03-23', 1, 101, 3, 750, 180),
(1002, '2023-02-01', 2, 102, 1, 700, 200),
(1003, '2023-03-28', 6, 105, 1, 900, 250),
(1004, '2023-03-17', 4, 101, 1, 250, 60),
(1005, '2023-01-12', 2, 102, 5, 3500, 1000),
(1006, '2023-03-19', 1, 105, 2, 1800, 500),
(1007, '2023-03-25', 6, 105, 4, 3600, 1000),
(1008, '2023-01-29', 4, 105, 3, 2700, 750),
(1009, '2023-01-01', 7, 107, 2, 400, 200),
(1010, '2023-03-31', 4, 103, 3, 3600, 900),
(1011, '2023-01-20', 2, 107, 3, 600, 300),
(1012, '2023-01-14', 1, 104, 1, 5, 10),
(1013, '2023-02-15', 7, 103, 5, 6000, 1500),
(1014, '2023-02-03', 7, 101, 4, 1000, 240),
(1015, '2023-03-10', 1, 104, 1, 5, 10),
(1016, '2023-03-12', 3, 107, 5, 1000, 500),
(1017, '2023-02-16', 5, 102, 1, 700, 200),
(1018, '2023-01-06', 6, 102, 3, 2100, 600),
(1019, '2023-01-11', 7, 102, 1, 700, 200),
(1020, '2023-02-18', 3, 104, 3, 15, 30),
(1021, '2023-01-21', 3, 103, 2, 2400, 600),
(1022, '2023-03-27', 3, 106, 1, 1500, 350),
(1023, '2023-03-19', 6, 102, 5, 3500, 1000),
(1024, '2023-02-01', 2, 104, 4, 20, 40),
(1025, '2023-02-04', 6, 106, 5, 7500, 1750),
(1026, '2023-01-29', 6, 103, 1, 1200, 300),
(1027, '2023-01-30', 7, 101, 3, 750, 180),
(1028, '2023-02-21', 3, 101, 2, 500, 120),
(1029, '2023-03-14', 6, 103, 2, 2400, 600),
(1030, '2023-03-25', 4, 104, 4, 20, 40),
(1031, '2023-01-19', 3, 102, 2, 1400, 400),
(1032, '2023-03-13', 5, 103, 5, 6000, 1500),
(1033, '2023-02-24', 5, 104, 3, 15, 30),
(1034, '2023-01-29', 2, 105, 4, 3600, 1000),
(1035, '2023-01-12', 7, 101, 1, 250, 60),
(1036, '2023-01-20', 6, 102, 4, 2800, 800),
(1037, '2023-03-18', 1, 104, 4, 20, 40),
(1038, '2023-03-18', 4, 105, 3, 2700, 750),
(1039, '2023-03-12', 7, 101, 1, 250, 60),
(1040, '2023-03-29', 5, 107, 3, 600, 300),
(1041, '2023-03-24', 3, 101, 3, 750, 180),
(1042, '2023-02-25', 2, 104, 1, 5, 10),
(1043, '2023-02-03', 5, 107, 2, 400, 200),
(1044, '2023-03-06', 1, 107, 3, 600, 300),
(1045, '2023-03-23', 5, 105, 2, 1800, 500),
(1046, '2023-01-20', 3, 107, 2, 400, 200),
(1047, '2023-03-11', 7, 105, 1, 900, 250),
(1048, '2023-03-18', 3, 104, 1, 5, 10),
(1049, '2023-01-15', 3, 107, 3, 600, 300),
(1050, '2023-01-31', 1, 102, 5, 3500, 1000),
(1051, '2023-01-11', 1, 106, 4, 6000, 1400),
(1052, '2023-01-09', 7, 105, 2, 1800, 500),
(1053, '2023-01-17', 6, 104, 5, 25, 50),
(1054, '2023-01-22', 3, 105, 5, 4500, 1250),
(1055, '2023-02-24', 2, 105, 2, 1800, 500),
(1056, '2023-02-09', 4, 106, 3, 4500, 1050),
(1057, '2023-02-26', 5, 104, 1, 5, 10),
(1058, '2023-02-01', 2, 101, 3, 750, 180),
(1059, '2023-01-03', 5, 105, 2, 1800, 500),
(1060, '2023-03-17', 2, 101, 1, 250, 60),
(1061, '2023-04-01', 6, 101, 2, 500, 120),
(1062, '2023-01-09', 1, 107, 3, 600, 300),
(1063, '2023-01-10', 5, 102, 3, 2100, 600),
(1064, '2023-03-27', 4, 102, 5, 3500, 1000),
(1065, '2023-01-17', 6, 105, 5, 4500, 1250),
(1066, '2023-03-02', 2, 107, 4, 800, 400),
(1067, '2023-02-22', 2, 101, 1, 250, 60),
(1068, '2023-03-26', 4, 103, 4, 4800, 1200),
(1069, '2023-02-22', 4, 107, 1, 200, 100),
(1070, '2023-03-28', 6, 106, 1, 1500, 350),
(1071, '2023-01-08', 4, 106, 3, 4500, 1050),
(1072, '2023-01-14', 2, 102, 2, 1400, 400),
(1073, '2023-03-10', 4, 102, 4, 2800, 800),
(1074, '2023-01-24', 3, 104, 2, 10, 20),
(1075, '2023-01-10', 4, 107, 5, 1000, 500),
(1076, '2023-01-13', 1, 106, 5, 7500, 1750),
(1077, '2023-01-02', 1, 107, 2, 400, 200),
(1078, '2023-01-22', 4, 104, 4, 20, 40),
(1079, '2023-01-28', 7, 104, 1, 5, 10),
(1080, '2023-01-22', 4, 101, 4, 1000, 240),
(1081, '2023-02-03', 7, 107, 4, 800, 400),
(1082, '2023-02-06', 4, 106, 5, 7500, 1750),
(1083, '2023-03-26', 6, 104, 2, 10, 20),
(1084, '2023-01-25', 3, 102, 1, 700, 200),
(1085, '2023-03-16', 6, 105, 1, 900, 250),
(1086, '2023-02-10', 1, 101, 5, 1250, 300),
(1087, '2023-03-03', 5, 107, 5, 1000, 500),
(1088, '2023-01-21', 1, 105, 1, 900, 250),
(1089, '2023-01-24', 1, 105, 1, 900, 250),
(1090, '2023-03-28', 7, 102, 4, 2800, 800),
(1091, '2023-01-16', 5, 102, 5, 3500, 1000),
(1092, '2023-03-18', 1, 105, 1, 900, 250),
(1093, '2023-02-23', 6, 105, 5, 4500, 1250),
(1094, '2023-03-08', 3, 103, 2, 2400, 600),
(1095, '2023-03-27', 6, 103, 2, 2400, 600),
(1096, '2023-02-03', 4, 102, 3, 2100, 600),
(1097, '2023-02-28', 3, 107, 1, 200, 100),
(1098, '2023-01-02', 4, 105, 5, 4500, 1250),
(1099, '2023-01-13', 1, 105, 2, 1800, 500),
(1100, '2023-03-06', 3, 102, 3, 2100, 600),
(1101, '2023-01-09', 2, 103, 3, 3600, 900),
(1102, '2023-01-21', 4, 107, 5, 1000, 500),
(1103, '2023-04-01', 3, 105, 5, 4500, 1250),
(1104, '2023-01-02', 6, 107, 5, 1000, 500),
(1105, '2023-02-08', 6, 101, 2, 500, 120),
(1106, '2023-02-03', 1, 101, 5, 1250, 300),
(1107, '2023-01-20', 3, 103, 5, 6000, 1500),
(1108, '2023-01-27', 6, 103, 2, 2400, 600),
(1109, '2023-03-29', 6, 107, 3, 600, 300),
(1110, '2023-03-06', 4, 103, 1, 1200, 300),
(1111, '2023-01-12', 6, 104, 3, 15, 30),
(1112, '2023-01-06', 1, 103, 2, 2400, 600),
(1113, '2023-03-23', 3, 102, 4, 2800, 800),
(1114, '2023-03-12', 6, 104, 5, 25, 50),
(1115, '2023-01-02', 1, 101, 2, 500, 120),
(1116, '2023-03-11', 1, 107, 3, 600, 300),
(1117, '2023-03-16', 5, 102, 4, 2800, 800),
(1118, '2023-01-17', 1, 103, 3, 3600, 900),
(1119, '2023-01-06', 3, 102, 2, 1400, 400),
(1120, '2023-03-27', 1, 103, 5, 6000, 1500),
(1121, '2023-02-22', 5, 106, 2, 3000, 700),
(1122, '2023-01-31', 7, 102, 2, 1400, 400),
(1123, '2023-02-22', 1, 102, 3, 2100, 600),
(1124, '2023-02-22', 7, 106, 2, 3000, 700),
(1125, '2023-02-04', 2, 107, 1, 200, 100),
(1126, '2023-02-18', 7, 101, 4, 1000, 240),
(1127, '2023-01-29', 2, 107, 4, 800, 400),
(1128, '2023-02-14', 3, 107, 2, 400, 200),
(1129, '2023-01-29', 1, 106, 2, 3000, 700),
(1130, '2023-02-21', 3, 103, 1, 1200, 300),
(1131, '2023-02-05', 3, 106, 5, 7500, 1750),
(1132, '2023-02-21', 6, 107, 5, 1000, 500),
(1133, '2023-02-12', 1, 101, 3, 750, 180),
(1134, '2023-01-23', 5, 103, 1, 1200, 300),
(1135, '2023-01-14', 5, 104, 3, 15, 30),
(1136, '2023-02-10', 4, 105, 5, 4500, 1250),
(1137, '2023-01-15', 4, 105, 2, 1800, 500),
(1138, '2023-02-02', 1, 106, 4, 6000, 1400),
(1139, '2023-01-01', 5, 107, 5, 1000, 500),
(1140, '2023-03-29', 6, 106, 2, 3000, 700),
(1141, '2023-02-16', 4, 101, 3, 750, 180),
(1142, '2023-03-21', 3, 106, 1, 1500, 350),
(1143, '2023-02-08', 5, 103, 4, 4800, 1200),
(1144, '2023-02-11', 4, 106, 3, 4500, 1050),
(1145, '2023-03-12', 2, 102, 4, 2800, 800),
(1146, '2023-03-27', 4, 106, 2, 3000, 700),
(1147, '2023-03-20', 5, 103, 4, 4800, 1200),
(1148, '2023-03-12', 7, 101, 3, 750, 180),
(1149, '2023-02-06', 2, 104, 5, 25, 50),
(1150, '2023-03-19', 6, 103, 4, 4800, 1200),
(1151, '2023-02-26', 4, 106, 2, 3000, 700),
(1152, '2023-03-07', 4, 107, 2, 400, 200),
(1153, '2023-03-26', 1, 103, 5, 6000, 1500),
(1154, '2023-03-26', 6, 105, 3, 2700, 750),
(1155, '2023-01-12', 7, 107, 2, 400, 200),
(1156, '2023-03-28', 3, 102, 2, 1400, 400),
(1157, '2023-01-19', 1, 101, 2, 500, 120),
(1158, '2023-03-02', 5, 107, 1, 200, 100),
(1159, '2023-02-28', 4, 106, 5, 7500, 1750),
(1160, '2023-01-25', 6, 106, 4, 6000, 1400),
(1161, '2023-03-05', 4, 102, 2, 1400, 400),
(1162, '2023-03-25', 6, 101, 1, 250, 60),
(1163, '2023-02-24', 2, 102, 5, 3500, 1000),
(1164, '2023-03-01', 1, 105, 2, 1800, 500),
(1165, '2023-01-16', 4, 102, 4, 2800, 800),
(1166, '2023-03-27', 5, 105, 5, 4500, 1250),
(1167, '2023-02-10', 7, 104, 5, 25, 50),
(1168, '2023-03-06', 4, 107, 5, 1000, 500),
(1169, '2023-02-27', 2, 106, 4, 6000, 1400),
(1170, '2023-02-27', 3, 107, 2, 400, 200),
(1171, '2023-03-23', 3, 107, 5, 1000, 500),
(1172, '2023-03-04', 6, 102, 3, 2100, 600),
(1173, '2023-02-26', 1, 106, 3, 4500, 1050),
(1174, '2023-01-31', 3, 103, 3, 3600, 900),
(1175, '2023-03-11', 1, 102, 2, 1400, 400),
(1176, '2023-01-30', 4, 106, 2, 3000, 700),
(1177, '2023-04-01', 2, 101, 4, 1000, 240),
(1178, '2023-02-22', 3, 105, 4, 3600, 1000),
(1179, '2023-02-23', 1, 102, 4, 2800, 800),
(1180, '2023-02-19', 7, 105, 1, 900, 250),
(1181, '2023-03-15', 4, 104, 1, 5, 10),
(1182, '2023-02-15', 3, 107, 4, 800, 400),
(1183, '2023-02-23', 5, 106, 5, 7500, 1750),
(1184, '2023-03-19', 2, 104, 2, 10, 20),
(1185, '2023-02-04', 4, 104, 1, 5, 10),
(1186, '2023-02-19', 3, 106, 4, 6000, 1400),
(1187, '2023-01-22', 7, 104, 2, 10, 20),
(1188, '2023-03-21', 5, 101, 4, 1000, 240),
(1189, '2023-03-17', 5, 106, 1, 1500, 350),
(1190, '2023-01-11', 6, 104, 2, 10, 20),
(1191, '2023-03-01', 2, 101, 3, 750, 180),
(1192, '2023-02-18', 3, 102, 4, 2800, 800),
(1193, '2023-02-11', 3, 107, 4, 800, 400),
(1194, '2023-02-05', 7, 107, 4, 800, 400),
(1195, '2023-02-02', 7, 101, 4, 1000, 240),
(1196, '2023-01-03', 6, 105, 1, 900, 250),
(1197, '2023-02-14', 2, 106, 1, 1500, 350),
(1198, '2023-03-25', 1, 107, 1, 200, 100),
(1199, '2023-02-01', 2, 107, 1, 200, 100),
(1200, '2023-03-21', 2, 102, 2, 1400, 400);

-- Calculate total sales Overall
select sum(sales) as total_sales , sum(profit) as total_profit
from sales;

-- Total sales and profit region wise
select Customers.Region , sum(Sales.Sales) as total_sales, sum(Sales.Profit) as Total_profit
from Customers
join Sales on Customers.CustomerID=Sales.CustomerID
group by Customers.Region
order by total_sales desc;

-- Top 5 total Sales and progit by product
select Products.Product , Sum(Sales.Sales) as Total_sales , Sum(Sales.Profit) as total_profit
from Products
join Sales on Products.ProductID=Sales.ProductID
group by Products.Product
order by Total_sales Desc
limit 5;

-- monthly wise Toal sales  
select date_format(OrderDAte,"%y-%m") as months, sum(Sales) as Monthly_Sales, sum(Profit) as Monthly_Profit
from Sales
group by months
order by months;

-- total spent by Customer with flag (high , Medium , low)
select Sales.CustomerID, sum(Sales) as Total_spent,
case 
    when Sum(Sales)>2000 Then "High"
    when sum(Sales) between 1000 and 2000 then "Medium"
    else "Low"
end as Flags
from Sales
group by Sales,CustomerID;

-- total Sales by Category and SAUbCAtegory
select Products.Category , Products.SubCategory , sum(Sales.Sales) as Total_sales
from Products
join Sales on Products.ProductID=Sales.ProductID
group by Products.category,Products.SubCategory
Order by Total_Sales desc;

